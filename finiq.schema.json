{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "required": [
        "name",
        "version",
        "title",
        "description",
        "completionTime",
        "modules"
    ],
    "properties": {
        "name": {
            "type": "string",
            "description": "ID of the lesson. Must be unique in the project."
        },
        "version": {
            "type": "integer",
            "description": "An integer starting from 1 to represent the version of this lesson."
        },
        "title": {
            "type": "string",
            "description": "A title that will appear when selecting or progressing through the lesson.",
            "minLength": 8,
            "maxLength": 32
        },
        "description": {
            "type": "string",
            "description": "A short description that briefly explains what is going to be taught, what the outcome is going to be, etc.",
            "minLength": 8
        },
        "completionTime": {
            "type": "integer",
            "description": "Roughly, how many minutes a user is going to take to finish this lesson.",
            "minimum": 0
        },
        "modules": {
            "type": "array",
            "description": "A list of modules - pages, that will make up the lesson.",
            "minItems": 1,
            "items": {
                "$ref": "#/definitions/module"
            }
        }
    },
    "definitions": {
        "module": {
            "type": "object",
            "required": [
                "module",
                "title",
                "mustValidate"
            ],
            "anyOf": [
                {
                    "required": [
                        "questionnaire"
                    ]
                },
                {
                    "required": [
                        "wordMatching"
                    ]
                },
                {
                    "required": [
                        "videoPlayer"
                    ]
                }
            ],
            "properties": {
                "module": {
                    "type": "string",
                    "description": "The ID of the module. Must be unique in the lesson.",
                    "minLength": 2,
                    "maxLength": 32
                },
                "title": {
                    "type": "string",
                    "description": "The title of the module that the user is going to see while progressing through the module."
                },
                "mustValidate": {
                    "type": "boolean",
                    "description": "Whether this module must be validated or not. If set to true, then the user won't be able to progress through the modules until they correctly submit the questionnaire or game.",
                    "default": false
                },
                "questionnaire": {
                    "type": "array",
                    "description": "A list of items that will make up a questionnaire or information page. Leave this non-empty to declare this module as a questionnaire page.",
                    "minItems": 1,
                    "items": {
                        "$ref": "#/definitions/questionnaireItem"
                    }
                },
                "wordMatching": {
                    "type": "array",
                    "description": "A list of items that will make up a word matching game. Leave this non-empty to declare this module as a word matching game.",
                    "minItems": 1,
                    "items": {
                        "$ref": "#/definitions/wordMatchingItem"
                    }
                },
                "videoPlayer": {
                    "type": "object",
                    "description": "The video player object that consists of a path to the video file and optionally subtitles. Leave this non-empty to declare this module as a video.",
                    "required": [
                        "video"
                    ],
                    "properties": {
                        "video": {
                            "type": "string",
                            "description": "The path to the video file on Good With's cloud storage service."
                        },
                        "subtitles": {
                            "type": "array",
                            "description": "A list of subtitle objects representing pairs of timestamps and subtitles.",
                            "items": {
                                "type": "object",
                                "description": "A subtitle object exposing a timestamp and the text shown in that moment. Eg. '0:05: this is a sub'"
                            }
                        }
                    }
                }
            }
        },
        "questionnaireItem": {
            "type": "object",
            "properties": {
                "item": {
                    "type": "string",
                    "description": "The ID of the item. Must be unique in the module.",
                    "minLength": 2,
                    "maxLength": 32
                },
                "question": {
                    "type": "string",
                    "description": "The question statement that the user will need to answer."
                },
                "options": {
                    "type": "array",
                    "description": "A list of options that the user can select from. To make this a multi select option list, set [multiSelect] to true."
                },
                "slider": {
                    "type": "array",
                    "description": "A list of options that the user can select from using a slider."
                },
                "answer": {
                    "description": "The correct answer of this question. Leave this null if this question does not have a correct answer."
                },
                "hint": {
                    "type": "string",
                    "description": "Correct explanation of this question. Leave this null if this question does not have an explanation."
                },
                "image": {
                    "type": "string",
                    "description": "Path to the image or gif that will be displayed. Can be combined with a [text] to create a polaroid-style image."
                },
                "text": {
                    "type": "string",
                    "description": "The text that will be displayed. Can be combined with an [image] to create a polaroid-style image."
                },
                "multiSelect": {
                    "type": "boolean",
                    "description": "Whether this item - as a [question] will have multi select [options].",
                    "default": false
                }
            },
            "required": [
                "item"
            ],
            "oneOf": [
                {
                    "required": [
                        "question",
                        "options"
                    ]
                },
                {
                    "required": [
                        "question",
                        "slider"
                    ]
                },
                {
                    "anyOf": [
                        {
                            "required": [
                                "image"
                            ]
                        },
                        {
                            "required": [
                                "text"
                            ]
                        }
                    ],
                    "not": {
                        "allOf": [
                            {
                                "required": [
                                    "question"
                                ]
                            },
                            {
                                "required": [
                                    "options"
                                ]
                            },
                            {
                                "required": [
                                    "slider"
                                ]
                            },
                            {
                                "required": [
                                    "answer"
                                ]
                            },
                            {
                                "required": [
                                    "hint"
                                ]
                            }
                        ]
                    }
                }
            ]
        },
        "wordMatchingItem": {
            "type": "object",
            "required": [
                "item"
            ],
            "oneOf": [
                {
                    "required": [
                        "text"
                    ]
                },
                {
                    "required": [
                        "image"
                    ]
                }
            ],
            "properties": {
                "item": {
                    "type": "string"
                },
                "match": {
                    "type": "string"
                },
                "text": {
                    "type": "string"
                },
                "image": {
                    "type": "string"
                }
            }
        }
    }
}